class FrontendErrorHandler{constructor(){this.setupGlobalErrorHandling(),this.messageContainer=null,this.createMessageContainer()}setupGlobalErrorHandling(){window.addEventListener("error",e=>{this.logError(e.error,"Global Error"),this.showUserMessage("An unexpected error occurred. Please refresh the page and try again.","error")}),window.addEventListener("unhandledrejection",e=>{this.logError(e.reason,"Unhandled Promise"),this.showUserMessage("A network or processing error occurred. Please try again.","error"),e.preventDefault()})}createMessageContainer(){if(document.getElementById("error-message-container"))this.messageContainer=document.getElementById("error-message-container");else{const e=document.createElement("div");e.id="error-message-container",e.style.cssText="\n                position: fixed;\n                top: 20px;\n                right: 20px;\n                z-index: 10000;\n                max-width: 400px;\n            ",document.body.appendChild(e),this.messageContainer=e}}async handleApiError(e,r={}){let o="An error occurred. Please try again.",n="error";if(e.response){const n=e.response.status,t=e.response.data;switch(n){case 400:o=t?.message||"Invalid request. Please check your input.";break;case 401:o="Authentication required. Please log in.";break;case 403:o="Access denied. You don't have permission for this action.";break;case 404:o="The requested resource was not found.";break;case 429:o="Too many requests. Please wait a moment and try again.";break;case 500:o="Server error. Please try again later.";break;default:o=t?.message||`Error ${n}: Please try again.`}if("VALIDATION_ERROR"===t?.error?.type&&t?.error?.details)return void this.handleValidationErrors(t.error.details,r.form)}else e.request?(o="Network error. Please check your connection and try again.",n="warning"):o=e.message||"An unexpected error occurred.";this.showUserMessage(o,n),r.form&&this.preserveFormData(r.form)}handleValidationErrors(e,r){Array.isArray(e)&&e.forEach(e=>{const o=r?.querySelector(`[name="${e.field}"]`);o?this.showFieldError(o,e.message):this.showUserMessage(e.message,"warning")})}showFieldError(e,r){const o=e.parentNode.querySelector(".field-error");o&&o.remove(),e.classList.add("error"),e.style.borderColor="#e74c3c";const n=document.createElement("div");n.className="field-error",n.textContent=r,n.style.cssText="\n            color: #e74c3c;\n            font-size: 0.875rem;\n            margin-top: 0.25rem;\n            display: block;\n        ",e.parentNode.insertBefore(n,e.nextSibling),e.addEventListener("input",()=>{e.classList.remove("error"),e.style.borderColor="",n.parentNode&&n.remove()},{once:!0})}showUserMessage(e,r="info",o=5e3){const n=document.createElement("div");n.className=`user-message message-${r}`;const t={error:{bg:"#fee",border:"#e74c3c",text:"#c0392b"},warning:{bg:"#fff3cd",border:"#f39c12",text:"#d68910"},success:{bg:"#d4edda",border:"#27ae60",text:"#1e8449"},info:{bg:"#d1ecf1",border:"#3498db",text:"#2980b9"}},s=t[r]||t.info;if(n.style.cssText=`\n            background-color: ${s.bg};\n            border: 1px solid ${s.border};\n            border-left: 4px solid ${s.border};\n            color: ${s.text};\n            padding: 12px 16px;\n            margin-bottom: 10px;\n            border-radius: 4px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n            animation: slideIn 0.3s ease-out;\n            cursor: pointer;\n            position: relative;\n        `,n.innerHTML=`\n            <div style="display: flex; justify-content: space-between; align-items: center;">\n                <span>${e}</span>\n                <span style="margin-left: 10px; font-weight: bold;">&times;</span>\n            </div>\n        `,!document.getElementById("message-animations")){const e=document.createElement("style");e.id="message-animations",e.textContent="\n                @keyframes slideIn {\n                    from { transform: translateX(100%); opacity: 0; }\n                    to { transform: translateX(0); opacity: 1; }\n                }\n                @keyframes slideOut {\n                    from { transform: translateX(0); opacity: 1; }\n                    to { transform: translateX(100%); opacity: 0; }\n                }\n            ",document.head.appendChild(e)}n.addEventListener("click",()=>{this.removeMessage(n)}),this.messageContainer.appendChild(n),o>0&&setTimeout(()=>{n.parentNode&&this.removeMessage(n)},o)}removeMessage(e){e.style.animation="slideOut 0.3s ease-in",setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300)}preserveFormData(e){if(!e)return;const r=new FormData(e),o={};for(let[e,n]of r.entries())o[e]=n;sessionStorage.setItem(`preserved_form_${e.id||"default"}`,JSON.stringify(o)),this.showUserMessage("Your form data has been preserved. You can continue where you left off.","info")}restoreFormData(e){if(!e)return;const r=e.id||"default",o=sessionStorage.getItem(`preserved_form_${r}`);if(o)try{const n=JSON.parse(o);Object.keys(n).forEach(r=>{const o=e.querySelector(`[name="${r}"]`);o&&(o.value=n[r])}),this.showUserMessage("Your previous form data has been restored.","success"),sessionStorage.removeItem(`preserved_form_${r}`)}catch(e){}}logError(e,r=""){(new Date).toISOString(),navigator.userAgent,window.location.href}async apiCall(e,r={}){try{return await e()}catch(e){throw await this.handleApiError(e,r),e}}checkNetworkStatus(){navigator.onLine||this.showUserMessage("You appear to be offline. Some features may not work properly.","warning",0),window.addEventListener("online",()=>{this.showUserMessage("Connection restored. You are back online.","success")}),window.addEventListener("offline",()=>{this.showUserMessage("Connection lost. You are currently offline.","warning",0)})}}document.addEventListener("DOMContentLoaded",()=>{window.errorHandler=new FrontendErrorHandler,window.errorHandler.checkNetworkStatus(),document.querySelectorAll("form").forEach(e=>{window.errorHandler.restoreFormData(e)})}),"undefined"!=typeof module&&module.exports&&(module.exports=FrontendErrorHandler);