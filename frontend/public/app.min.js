function initWelcomeScreen(){const e=document.getElementById("welcome-screen");e&&(setTimeout(()=>{e.classList.add("hidden"),document.body.style.overflow="auto"},3e3),document.body.style.overflow="hidden")}function initThemeToggle(){const e=document.getElementById("theme-toggle"),t=e.querySelector(".theme-icon"),o=localStorage.getItem("theme")||"dark";function n(o){t.textContent="dark"===o?"☀️":"🌙",e.setAttribute("aria-label",`Switch to ${"dark"===o?"light":"dark"} theme`)}document.documentElement.setAttribute("data-theme",o),n(o),e.addEventListener("click",()=>{const t="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";document.documentElement.setAttribute("data-theme",t),localStorage.setItem("theme",t),n(t),e.style.transform="scale(0.9)",setTimeout(()=>{e.style.transform="scale(1)"},150)})}function initNavigation(){const e=document.getElementById("navbar"),t=document.getElementById("nav-toggle"),o=document.querySelector(".nav-menu"),n=document.querySelectorAll(".nav-link");t&&o&&t.addEventListener("click",()=>{o.classList.toggle("active"),t.classList.toggle("active"),o.classList.contains("active")?document.body.style.overflow="hidden":document.body.style.overflow="auto"}),n.forEach(e=>{e.addEventListener("click",n=>{n.preventDefault(),o&&(o.classList.remove("active"),t.classList.remove("active"),document.body.style.overflow="auto");const r=e.getAttribute("href"),s=document.querySelector(r);if(s){const e=s.offsetTop-80;window.scrollTo({top:e,behavior:"smooth"})}})}),window.addEventListener("scroll",()=>{e&&(window.scrollY>100?e.classList.add("scrolled"):e.classList.remove("scrolled")),updateActiveNavLink()})}function updateActiveNavLink(){const e=document.querySelectorAll("section[id]"),t=document.querySelectorAll(".nav-link");let o="";e.forEach(e=>{const t=e.offsetTop-150,n=e.offsetHeight;window.scrollY>=t&&window.scrollY<t+n&&(o=e.getAttribute("id"))}),t.forEach(e=>{e.classList.remove("active"),e.getAttribute("href")===`#${o}`&&e.classList.add("active")})}function initHero(){const e=document.querySelector(".hero-particles");window.addEventListener("scroll",()=>{const t=-.5*window.pageYOffset;e&&(e.style.transform=`translateY(${t}px)`)})}function initAnimations(){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("scroll-reveal"),t.target.classList.contains("stat-card")&&animateCounter(t.target),e.unobserve(t.target))})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});document.querySelectorAll("\n        .service-card,\n        .project-card,\n        .testimonial-card,\n        .stat-card,\n        .contact-card,\n        .glass-card\n    ").forEach(t=>e.observe(t))}function initCounters(){}function animateCounter(e){const t=e.querySelector(".stat-number");if(!t)return;const o=parseInt(t.getAttribute("data-target")),n=o/125;let r=0;const s=()=>{r+=n,r<o?(t.textContent=Math.floor(r),requestAnimationFrame(s)):t.textContent=o+"+"};s()}function initForms(){const e=document.getElementById("contact-form");if(e){e.querySelectorAll("input, select, textarea").forEach(e=>{e.addEventListener("blur",validateField),e.addEventListener("input",debounce(clearFieldError,300))}),e.addEventListener("submit",handleFormSubmit)}}function validateField(e){const t=e.target,o=t.value.trim(),n=t.name;clearFieldError(t);const r={name:{required:!0,minLength:2,maxLength:100,pattern:/^[a-zA-Z\s\.]+$/,message:"Name must be 2-100 characters and contain only letters, spaces, and dots"},email:{required:!0,pattern:/^\S+@\S+\.\S+$/,message:"Please enter a valid email address"},phone:{pattern:/^[\+]?[1-9][\d]{0,15}$/,message:"Please enter a valid phone number"},service:{required:!0,message:"Please select a service"},message:{required:!0,minLength:10,maxLength:2e3,message:"Message must be between 10 and 2000 characters"}}[n];if(r)return r.required&&!o?(showFieldError(t,`${n.charAt(0).toUpperCase()+n.slice(1)} is required`),!1):o&&r.pattern&&!r.pattern.test(o)||o&&r.minLength&&o.length<r.minLength?(showFieldError(t,r.message),!1):!(o&&r.maxLength&&o.length>r.maxLength)||(showFieldError(t,r.message),!1)}function clearFieldError(e){"object"==typeof e&&e.target&&(e=e.target);const t=e.closest(".form-group");if(t){t.classList.remove("error");const e=t.querySelector(".field-error");e&&e.remove()}}async function handleFormSubmit(e){e.preventDefault();const t=e.target,o=new FormData(t),n=t.querySelector('button[type="submit"]'),r=n.querySelector("span").textContent;if(n.classList.add("loading"),n.querySelector("span").textContent="Sending...",n.disabled=!0,clearFormErrors(t),!validateForm(t,o))return void resetSubmitButton(n,r);const s={name:o.get("name").trim(),email:o.get("email").trim(),phone:o.get("phone")?.trim()||"",company:o.get("company")?.trim()||"",service:o.get("service"),message:o.get("message").trim()};try{const e="localhost"===window.location.hostname?"http://localhost:3000":window.location.origin,o=await fetch(`${e}/api/contact`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),n=await o.json();if(!n.success)throw new Error(n.message||"Failed to send message");showSuccessModal(),t.reset(),showSuccessMessage("Thank you! Your message has been sent successfully.")}catch(e){console.error("❌ Form submission error:",e),showErrorMessage("Failed to send message. Please try again or contact us directly.")}finally{resetSubmitButton(n,r)}}function validateForm(e,t){let o=!0;["name","email","service","message"].forEach(n=>{const r=t.get(n),s=e.querySelector(`[name="${n}"]`);r&&""!==r.trim()||(showFieldError(s,`${n.charAt(0).toUpperCase()+n.slice(1)} is required`),o=!1)});const n=t.get("email");if(n&&!isValidEmail(n)){showFieldError(e.querySelector('[name="email"]'),"Please enter a valid email address"),o=!1}return o}function isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function showFieldError(e,t){const o=e.closest(".form-group");o.classList.add("error");const n=o.querySelector(".field-error");n&&n.remove();const r=document.createElement("div");r.className="field-error",r.textContent=t,r.style.cssText="\n        color: #fca5a5;\n        font-size: 0.875rem;\n        margin-top: 0.25rem;\n    ",o.appendChild(r)}function clearFormErrors(e){e.querySelectorAll(".form-group.error").forEach(e=>{e.classList.remove("error");const t=e.querySelector(".field-error");t&&t.remove()});e.querySelectorAll(".form-error").forEach(e=>e.remove())}function showErrorMessage(e){const t=document.createElement("div");t.className="form-error",t.textContent=e;const o=document.querySelector("form");o&&(o.insertBefore(t,o.firstChild),setTimeout(()=>{t.parentNode&&t.remove()},5e3),t.scrollIntoView({behavior:"smooth",block:"center"}))}function showSuccessMessage(e){const t=document.createElement("div");t.className="form-success",t.textContent=e;const o=document.querySelector("form");o&&(o.insertBefore(t,o.firstChild),setTimeout(()=>{t.parentNode&&t.remove()},5e3))}function resetSubmitButton(e,t){e.classList.remove("loading"),e.querySelector("span").textContent=t,e.disabled=!1}function initModal(){const e=document.getElementById("success-modal"),t=document.getElementById("modal-close"),o=document.getElementById("modal-ok");t&&t.addEventListener("click",hideSuccessModal),o&&o.addEventListener("click",hideSuccessModal),e&&e.addEventListener("click",t=>{(t.target===e||t.target.classList.contains("modal-backdrop"))&&hideSuccessModal()}),document.addEventListener("keydown",t=>{"Escape"===t.key&&e&&e.classList.contains("show")&&hideSuccessModal()})}function showSuccessModal(){const e=document.getElementById("success-modal");e&&(e.classList.add("show"),document.body.style.overflow="hidden")}function hideSuccessModal(){const e=document.getElementById("success-modal");e&&(e.classList.remove("show"),document.body.style.overflow="auto")}function initScrollEffects(){const e=document.getElementById("scroll-progress"),t=document.getElementById("back-to-top");window.addEventListener("scroll",()=>{if(e){const t=window.pageYOffset/(document.documentElement.scrollHeight-window.innerHeight)*100;e.style.width=t+"%"}t&&(window.pageYOffset>300?t.classList.add("show"):t.classList.remove("show"))}),t&&t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}function debounce(e,t){let o;return function(...n){clearTimeout(o),o=setTimeout(()=>{clearTimeout(o),e(...n)},t)}}function throttle(e,t){let o;return function(){const n=arguments,r=this;o||(e.apply(r,n),o=!0,setTimeout(()=>o=!1,t))}}document.addEventListener("DOMContentLoaded",function(){initWelcomeScreen(),initNavigation(),initThemeToggle(),initHero(),initAnimations(),initForms(),initModal(),initScrollEffects(),initCounters()});const optimizedScrollHandler=throttle(()=>{updateActiveNavLink()},100);function preloadImages(){["https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=1920&h=1080&fit=crop&q=80","https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=600&h=400&fit=crop&q=80","https://images.unsplash.com/photo-1504307651254-35680f356dfd?w=600&h=400&fit=crop&q=80"].forEach(e=>{(new Image).src=e})}function initImageLoading(){document.querySelectorAll("img").forEach(e=>{e.complete?e.classList.add("loaded"):(e.addEventListener("load",function(){this.classList.add("loaded")}),e.addEventListener("error",function(){this.classList.add("error")}))})}function trapFocus(e){const t=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),o=t[0],n=t[t.length-1];e.addEventListener("keydown",e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===o&&(n.focus(),e.preventDefault()):document.activeElement===n&&(o.focus(),e.preventDefault()))})}function trackEvent(e,t={}){console.log("Event tracked:",e,t)}window.addEventListener("scroll",optimizedScrollHandler),preloadImages(),initImageLoading(),document.addEventListener("keydown",e=>{"Tab"===e.key&&e.shiftKey}),window.addEventListener("unhandledrejection",e=>{console.error("Unhandled promise rejection:",e.reason)}),"serviceWorker"in navigator&&window.addEventListener("load",()=>{}),document.addEventListener("submit",e=>{"FORM"===e.target.tagName&&trackEvent("form_submit",{form_id:e.target.id,form_type:"contact"})}),document.addEventListener("click",e=>{if(e.target.closest(".theme-toggle")){const e=document.documentElement.getAttribute("data-theme");trackEvent("theme_change",{from_theme:e,to_theme:"dark"===e?"light":"dark"})}}),document.addEventListener("click",e=>{e.target.classList.contains("btn")&&trackEvent("button_click",{button_text:e.target.textContent.trim(),button_type:e.target.classList.contains("btn-primary")?"primary":"secondary"})});const performanceMetrics={startTime:performance.now(),trackCoreWebVitals(){new PerformanceObserver(e=>{const t=e.getEntries(),o=t[t.length-1];console.log("LCP:",o.startTime),this.metrics.lcp=o.startTime}).observe({entryTypes:["largest-contentful-paint"]}),new PerformanceObserver(e=>{const t=e.getEntries()[0];t&&(console.log("FID:",t.processingStart-t.startTime),this.metrics.fid=t.processingStart-t.startTime)}).observe({entryTypes:["first-input"]});let e=0;new PerformanceObserver(t=>{for(const o of t.getEntries())o.hadRecentInput||(e+=o.value);console.log("CLS:",e),this.metrics.cls=e}).observe({entryTypes:["layout-shift"]})},trackPageLoad(){window.addEventListener("load",()=>{const e=performance.now()-this.startTime;console.log("Total page load time:",e.toFixed(2),"ms");const t=performance.getEntriesByType("navigation")[0];t&&console.log("Navigation metrics:",{dns:t.domainLookupEnd-t.domainLookupStart,tcp:t.connectEnd-t.connectStart,request:t.responseStart-t.requestStart,response:t.responseEnd-t.responseStart,dom:t.domContentLoadedEventEnd-t.domContentLoadedEventStart,load:t.loadEventEnd-t.loadEventStart})})},trackResources(){const e=performance.getEntriesByType("resource").filter(e=>e.duration>1e3);e.length>0&&console.warn("Slow loading resources:",e.map(e=>({name:e.name,duration:e.duration.toFixed(2)+"ms"})))},metrics:{}};function optimizeImages(){const e=document.querySelectorAll('img[loading="lazy"]');if("IntersectionObserver"in window){const t=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){const o=e.target;o.style.backgroundColor="var(--glass-bg)",o.addEventListener("load",()=>{o.style.backgroundColor="transparent",o.classList.add("loaded")}),t.unobserve(o)}})},{rootMargin:"50px 0px"});e.forEach(e=>t.observe(e))}}function improveAccessibility(){const e=document.createElement("a");e.href="#main-content",e.textContent="Skip to main content",e.className="sr-only",e.style.cssText="\n        position: absolute;\n        top: -40px;\n        left: 6px;\n        background: var(--color-gold-500);\n        color: var(--color-white);\n        padding: 8px;\n        text-decoration: none;\n        border-radius: 4px;\n        z-index: 1000;\n        transition: top 0.3s;\n    ",e.addEventListener("focus",()=>{e.style.top="6px"}),e.addEventListener("blur",()=>{e.style.top="-40px"}),document.body.insertBefore(e,document.body.firstChild);const t=document.querySelector(".hero");t&&t.setAttribute("id","main-content")}function detectSystemTheme(){const e=window.matchMedia("(prefers-color-scheme: dark)").matches;if(!localStorage.getItem("theme")){const t=e?"dark":"light";document.documentElement.setAttribute("data-theme",t),localStorage.setItem("theme",t)}}"undefined"!=typeof PerformanceObserver&&(performanceMetrics.trackCoreWebVitals(),performanceMetrics.trackPageLoad(),window.addEventListener("load",()=>{setTimeout(()=>performanceMetrics.trackResources(),1e3)})),optimizeImages(),improveAccessibility(),window.matchMedia("(prefers-reduced-motion: reduce)").matches&&(document.documentElement.style.setProperty("--transition-fast","0ms"),document.documentElement.style.setProperty("--transition-normal","0ms"),document.documentElement.style.setProperty("--transition-slow","0ms")),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{if(!localStorage.getItem("theme")){const t=e.matches?"dark":"light";document.documentElement.setAttribute("data-theme",t);const o=document.querySelector(".theme-icon");o&&(o.textContent="dark"===t?"☀️":"🌙")}}),detectSystemTheme(),console.log("\n🏗️ MB Construction Website\nBuilding Tomorrow, Today\n\nDeveloped with ❤️ using modern web technologies\n- Glassmorphism UI\n- Smooth animations\n- Responsive design\n- Accessibility focused\n- Performance optimized\n\n© 2025 MB Construction. All rights reserved.\n"),"undefined"!=typeof module&&module.exports&&(module.exports={validateForm:validateForm,isValidEmail:isValidEmail,debounce:debounce,throttle:throttle});